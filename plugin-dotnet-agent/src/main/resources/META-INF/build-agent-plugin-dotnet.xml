<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"
       default-autowire="constructor">

    <!-- general services -->
    <bean class="jetbrains.buildServer.runners.ArgumentsServiceImpl"/>
    <bean class="jetbrains.buildServer.runners.ParametersServiceImpl"/>
    <bean class="jetbrains.buildServer.runners.FileSystemServiceImpl"/>
    <bean class="jetbrains.buildServer.runners.PathsServiceImpl"/>
    <bean class="jetbrains.buildServer.runners.LoggerServiceImpl"/>
    <bean class="jetbrains.buildServer.runners.LayeredWorkflowComposer" id="layeredWorkflowComposer"/>
    <bean class="jetbrains.buildServer.runners.WorkflowSessionImpl" scope="prototype">
        <constructor-arg ref="layeredWorkflowComposer"/>
    </bean>
    <bean class="jetbrains.buildServer.runners.XmlDocumentServiceImpl"/>

    <!-- plugin -->
    <bean class="jetbrains.buildServer.runners.WorkflowBuildServiceFactory">
        <constructor-arg value="dotnet"/>
    </bean>
    <bean class="jetbrains.buildServer.dotnet.DotnetToolProvider"/>
    <bean class="jetbrains.buildServer.dotnet.DotnetPropertiesExtension"/>
    <bean class="jetbrains.buildServer.dotnet.DotnetCacheCleaner"/>

    <!-- dotnet workflow composer -->
    <bean class="jetbrains.buildServer.dotnet.DotnetWorkflowComposer" id="dotnetWorkflowComposer">
        <constructor-arg ref="dotnetArgumentsProvider"/>
    </bean>
    <bean class="jetbrains.buildServer.dotnet.DotnetSdkVersionProviderImpl"/>
    <bean class="jetbrains.buildServer.dotnet.EnvironmentVariablesImpl"/>
    <bean class="jetbrains.buildServer.dotnet.DotnetLoggerProviderImpl"/>

    <!--Dotnet arguments' providers-->
    <bean class="jetbrains.buildServer.dotnet.arguments.DotnetArgumentsProvider" id="dotnetArgumentsProvider">
        <constructor-arg ref="msBuildLoggerArgumentsProvider"/>
        <constructor-arg ref="dotnetCustomArgumentsProvider"/>
        <constructor-arg ref="dotnetVerbosityArgumentsProvider"/>
    </bean>
    <bean class="jetbrains.buildServer.dotnet.arguments.MSBuildLoggerArgumentsProvider" id="msBuildLoggerArgumentsProvider" />
    <bean class="jetbrains.buildServer.dotnet.arguments.VSTestLoggerArgumentsProvider" id="vsTestLoggerArgumentsProvider" />
    <bean class="jetbrains.buildServer.dotnet.arguments.CustomArgumentsProvider" id="dotnetCustomArgumentsProvider" />
    <bean class="jetbrains.buildServer.dotnet.arguments.VerbosityArgumentsProvider" id="dotnetVerbosityArgumentsProvider" />

    <bean class="jetbrains.buildServer.dotnet.arguments.BuildArgumentsProvider" id="dotnetBuildArgumentsProvider"/>
    <bean class="jetbrains.buildServer.dotnet.arguments.NugetDeleteArgumentsProvider" id="dotnetNugetDeleteArgumentsProvider"/>
    <bean class="jetbrains.buildServer.dotnet.arguments.NugetPushArgumentsProvider" id="dotnetNugetPushArgumentsProvider"/>
    <bean class="jetbrains.buildServer.dotnet.arguments.PackArgumentsProvider" id="dotnetPackArgumentsProvider"/>
    <bean class="jetbrains.buildServer.dotnet.arguments.PublishArgumentsProvider" id="dotnetPublishArgumentsProvider"/>
    <bean class="jetbrains.buildServer.dotnet.arguments.RestoreArgumentsProvider" id="dotnetRestoreArgumentsProvider"/>
    <bean class="jetbrains.buildServer.dotnet.arguments.RunArgumentsProvider" id="dotnetRunArgumentsProvider"/>
    <bean class="jetbrains.buildServer.dotnet.arguments.TestArgumentsProvider" id="dotnetTestArgumentsProvider">
        <constructor-arg ref="vsTestLoggerArgumentsProvider"/>
    </bean>
    <bean class="jetbrains.buildServer.dotnet.arguments.CleanArgumentsProvider" id="dotnetCleanArgumentsProvider"/>

    <!-- dotCover workflow composer -->
    <bean class="jetbrains.buildServer.dotcover.DotCoverWorkflowComposer" id="dotCoverWorkflowComposer" />
    <bean class="jetbrains.buildServer.dotcover.DotCoverProjectSerializerImpl"/>
    <bean class="jetbrains.buildServer.dotcover.CoverageFilterProviderImpl"/>
    <bean class="jetbrains.buildServer.dotcover.DotCoverFilterConverter"/>
</beans>